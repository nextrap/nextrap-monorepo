// Styling for the progress bar component
@use '@nextrap/style-reset';
/* The ShadowDOM Styles */

:host {
  display: block;

  /* Customizable variables */
  --rating-star-size: 1.5rem;
  --rating-star-gap: 0.25rem;
  --rating-color-filled: var(--nt-warning);
  --rating-color-empty: var(--nt-dark-subtle);
  --rating-color-hover: var(--nt-warning-emphasis);
  --rating-label-color: var(--nt-dark, #374151);
  --rating-text-color: var(--nt-dark-subtle, #6b7280);
  --rating-required-color: var(--nt-danger);
  --rating-hint-color: var(--nt-dark-subtle, #6b7280);
  --rating-focus-ring: var(--nt-primary);
  --rating-disabled-opacity: 0.5;

  /* Size variants */
  --rating-star-size-sm: 1rem;
  --rating-star-size-md: 1.5rem;
  --rating-star-size-lg: 2rem;
  --rating-star-gap-sm: 0.125rem;
  --rating-star-gap-md: 0.25rem;
  --rating-star-gap-lg: 0.375rem;

  /* container width hint for consistency */
  --container-width: var(--nt-container-width);
}

.rating {
  display: flex;
  flex-direction: column;
  gap: 0.5rem;

  // Size variants
  &--sm {
    --rating-star-size: var(--rating-star-size-sm);
    --rating-star-gap: var(--rating-star-gap-sm);

    .rating__text {
      font-size: 0.875rem; /* text-sm */
    }
  }

  &--md {
    --rating-star-size: var(--rating-star-size-md);
    --rating-star-gap: var(--rating-star-gap-md);
  }

  &--lg {
    --rating-star-size: var(--rating-star-size-lg);
    --rating-star-gap: var(--rating-star-gap-lg);

    .rating__text {
      font-size: 1.125rem; /* text-lg */
    }
  }

  // Interactive state
  &--interactive {
    .rating__star {
      cursor: pointer;
      transition: all 0.15s ease-out;

      &:focus-visible {
        outline: none;
        box-shadow: 0 0 0 2px var(--rating-focus-ring);
        border-radius: 0.25rem;
      }

      &:hover {
        transform: scale(1.1);
      }
    }
  }

  // Disabled state
  &--disabled {
    opacity: var(--rating-disabled-opacity);
    pointer-events: none;
  }
}

.rating__label {
  font-size: 1rem;
  font-weight: 500;
  color: var(--rating-label-color);
  margin-bottom: 0.25rem;
}

.rating__required {
  color: var(--rating-required-color);
  margin-left: 0.25rem;
}

.rating__stars {
  display: flex;
  align-items: center;
  gap: var(--rating-star-gap);
}

.rating__star {
  display: flex;
  align-items: center;
  justify-content: center;
  width: var(--rating-star-size);
  height: var(--rating-star-size);
  border: none;
  background: none;
  padding: 0;
  cursor: pointer;
  transition: all 0.15s ease-out;

  &:disabled {
    cursor: default;
  }
}

.rating__star-icon {
  font-size: var(--rating-star-size);
  line-height: 1;
  transition: all 0.15s ease-out;
  display: flex;
  align-items: center;
  justify-content: center;

  /* Star gradient effect implementation */
  color: var(--rating-color-empty);
  background: linear-gradient(
    to right,
    var(--rating-color-filled),
    var(--rating-color-filled) var(--fill-ratio),
    var(--rating-color-empty) var(--fill-ratio),
    var(--rating-color-empty)
  );
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;

  /* Fallback for browsers that don't support background-clip: text */
  @supports not (-webkit-background-clip: text) {
    color: var(--rating-color-empty);

    .rating__star--filled & {
      color: var(--rating-color-filled);
    }

    .rating__star--half & {
      background: linear-gradient(to right, var(--rating-color-filled) 50%, var(--rating-color-empty) 50%);
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }
  }
}

.rating__text {
  font-size: 1rem;
  color: var(--rating-text-color);
  font-weight: 500;
}

.rating__hint {
  font-size: 0.875rem;
  color: var(--rating-hint-color);
  line-height: 1.5;
}

// === ACCESSIBILITY ===
@media (prefers-reduced-motion: reduce) {
  .rating {
    .rating__star {
      transition: none;
    }

    .rating__star-icon {
      transition: none;
    }
  }
}

// === RESPONSIVE DESIGN ===
@media (max-width: 768px) {
  .rating {
    &--lg {
      --rating-star-size: var(--rating-star-size-md);
      --rating-star-gap: var(--rating-star-gap-md);
    }
  }
}
